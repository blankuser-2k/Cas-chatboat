<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CAS Chat ‚Äî College of Applied Science, Vattamkulam</title>

<link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --rose: #ff9acb;
    --blue: #6ea8ff;
    --accent-blue: #0b63ff;        /* user bubble */
    --user-text: #000000;          /* user text black */
    --bot-bg: #000000;             /* bot bubble black */
    --bot-green: #39ff14;          /* bot text green */
    --glass: rgba(255,255,255,0.92);
    --input-bg: rgba(255,255,255,0.96);
    --suggest-grad: linear-gradient(135deg, #00ff99, #00aaff);
    --suggest-text: #05264a;
  }

  html,body { height:100%; margin:0; font-family:"Poppins",system-ui,Arial,sans-serif; -webkit-font-smoothing:antialiased; }
  body{
    background: linear-gradient(135deg, var(--rose) 0%, #ffd7e6 30%, #cfe7ff 70%, var(--blue) 100%);
    display:flex; align-items:center; justify-content:center; padding:14px; box-sizing:border-box;
  }

  /* container */
  .wrap{
    width:100%;
    max-width:980px;
    height:92vh;
    display:flex; flex-direction:column;
    border-radius:16px;
    overflow:hidden;
    box-shadow: 0 22px 50px rgba(8,20,40,0.18);
    background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.65));
    border: 1px solid rgba(255,255,255,0.2);
  }

  header{
    display:flex; gap:14px; align-items:center; padding:14px 18px;
    background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  }
  .logo{ width:56px; height:56px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:white; }
  .logo .cas{ font-family:"Abril Fatface", serif; color:var(--accent-blue); font-size:20px; }
  .head-text{ display:flex; flex-direction:column; }
  .head-text .title{ font-weight:700; color:#060606; font-size:18px; }
  .head-text .sub{ font-size:12px; color:rgba(0,0,0,0.6); }

  .body{ padding:12px; display:flex; flex-direction:column; gap:12px; height:100%; box-sizing:border-box; }

  /* suggestion grid */
  .suggest-grid{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
    gap:10px;
  }
  .suggest{
    background: white;
    border-radius:12px;
    border: 1px solid rgba(11,63,136,0.06);
    min-height:96px;
    display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px;
    cursor:pointer; padding:10px; transition: transform .12s ease, box-shadow .12s ease;
    text-align:center;
    box-shadow: 0 8px 24px rgba(11,30,60,0.04);
  }
  .suggest .emoji{ font-size:28px; }
  .suggest .label{ font-size:13px; color:var(--suggest-text); font-weight:600; }
  .suggest:active{ transform: translateY(2px); }

  /* chat area */
  #chatbox{ flex:1; overflow:auto; padding:12px; display:flex; flex-direction:column; gap:12px; -webkit-overflow-scrolling:touch; }

  .msg-row{ display:flex; }
  .msg-row.bot{ justify-content:flex-start; }
  .msg-row.you{ justify-content:flex-end; }

  .bubble{
    padding:12px 14px; border-radius:18px; max-width:78%; word-wrap:break-word; font-size:15px; line-height:1.35;
    box-shadow: 0 8px 26px rgba(11,30,60,0.06);
    white-space: pre-wrap;
  }
  .bubble.you{ background: var(--accent-blue); color: var(--user-text); border-bottom-right-radius:6px; border-bottom-left-radius:18px; }
  .bubble.bot{ background: var(--bot-bg); color: var(--bot-green); border-bottom-left-radius:6px; border-bottom-right-radius:18px; }

  /* typing indicator */
  .typing{ padding:8px 10px; border-radius:12px; background: rgba(0,0,0,0.85); display:inline-flex; gap:6px; align-items:center; }
  .dot{ width:7px; height:7px; border-radius:50%; background:var(--bot-green); animation: blink 1s infinite; }
  .dot:nth-child(2){ animation-delay:.2s; } .dot:nth-child(3){ animation-delay:.4s; }
  @keyframes blink{ 0%{opacity:.2} 50%{opacity:1} 100%{opacity:.2} }

  /* input */
  .input-area{ display:flex; gap:10px; align-items:center; padding:10px; background: linear-gradient(180deg, rgba(255,255,255,0.62), rgba(255,255,255,0.44)); }
  #userInput{ flex:1; height:48px; padding:12px 16px; border-radius:28px 6px 28px 6px; border:none; outline:none; background:var(--input-bg); font-size:15px; }
  .btn-send{ min-width:92px; height:44px; border-radius:10px; border:none; cursor:pointer; font-weight:700; color:white;
    background: var(--suggest-grad); box-shadow: 0 10px 26px rgba(0,160,200,0.12); }

  /* autosuggest dropdown */
  .autosuggest-wrap{ position:relative; }
  .suggest-list{ position:absolute; left:8px; right:8px; bottom:64px; display:flex; flex-direction:column; gap:8px; padding:10px; background:white; border-radius:10px; box-shadow:0 12px 40px rgba(11,30,60,0.08); z-index:45; }
  .suggest-item{ padding:8px 10px; border-radius:8px; cursor:pointer; font-size:14px; color:#082a4a; font-weight:600; }
  .suggest-item:hover{ background: #f0fbff; }

  /* suggestion button color change - gradient applied on actual button labels for color */
  .suggest .label.small{ font-size:12px; color:#053052; }

  @media (max-width:720px){
    .wrap{ height:96vh; border-radius:12px; }
    .suggest{ min-height:84px; }
    .bubble{ font-size:14px; }
    #userInput{ height:44px; font-size:14px; }
  }
</style>
</head>
<body>
  <div class="wrap" role="application" aria-label="CAS chatbot">
    <header>
      <div class="logo"><div class="cas">CAS</div></div>
      <div class="head-text">
        <div class="title">CHATBOT - CAS</div>
        <div class="sub">College of Applied Science, Vattamkulam</div>
      </div>
    </header>

    <div class="body">
      <!-- suggestion grid -->
      <div class="suggest-grid" id="suggestGrid" aria-hidden="false">
        <div class="suggest" data-q="timing"><div class="emoji">üïí</div><div class="label">Timing</div></div>
        <div class="suggest" data-q="address"><div class="emoji">üìç</div><div class="label">Address</div></div>
        <div class="suggest" data-q="courses"><div class="emoji">üéì</div><div class="label">Courses</div></div>
        <div class="suggest" data-q="fees"><div class="emoji">üí∞</div><div class="label">Fees</div></div>
        <div class="suggest" data-q="admission"><div class="emoji">üìù</div><div class="label">Admission</div></div>
        <div class="suggest" data-q="departments"><div class="emoji">üè´</div><div class="label">Departments</div></div>
        <div class="suggest" data-q="clubs"><div class="emoji">‚ö°</div><div class="label">Clubs & Activities</div></div>
        <div class="suggest" data-q="contact"><div class="emoji">üìû</div><div class="label">Contact</div></div>
        <div class="suggest" data-q="scholarship"><div class="emoji">üéÅ</div><div class="label">Scholarship</div></div>
        <div class="suggest" data-q="exams"><div class="emoji">üìù</div><div class="label">Exams / Syllabus</div></div>
      </div>

      <!-- chat area -->
      <div id="chatbox" role="log" aria-live="polite"></div>

      <!-- input + autosuggest -->
      <div class="autosuggest-wrap">
        <div class="input-area">
          <input id="userInput" type="text" placeholder="Type a question (e.g. 'BCA fee', 'PG admission', 'What is CAS?')" autocomplete="off" />
          <button class="btn-send" id="sendBtn" aria-label="Send">Send</button>
        </div>
        <div id="suggestList" class="suggest-list" style="display:none;"></div>
      </div>
    </div>
  </div>

<script>
/* ---------------------------
   Knowledge base & course fees
----------------------------*/
const KB = [
  { q: ["what is cas","cas means","cas meaning","cas"], a: "CAS stands for College of Applied Science, Vattamkulam." },

  { q: ["address","location","where"], a:
    "College Address:\nThe Principal,\nCollege of Applied Science, Vattamkulam, Nellissery, Sukapuram (P.O.), Edappal, Malappuram, Kerala, PIN - 679576" },

  { q: ["phone","contact","telephone","call","office"], a: "Phone: 0494 2689655" },
  { q: ["email","mail"], a: "Email: casvattamkulam@ihrd.ac.in" },

  { q: ["time","timing","hours","college time"], a: "College time is 9:30 AM to 3:45 PM (Monday to Friday)." },

  { q: ["courses","what courses","available courses"], a: "Courses offered:\n‚Ä¢ B.Sc (Computer Science)\n‚Ä¢ B.Sc (Electronics)\n‚Ä¢ BCA\n‚Ä¢ B.Com with Computer Application\n‚Ä¢ M.Sc (Computer Science)\n‚Ä¢ M.Com (Finance)" },

  { q: ["departments","department","which departments"], a:
    "Departments:\n‚Ä¢ Department of Commerce\n‚Ä¢ Department of Computer Science\n‚Ä¢ Department of Electronics\n‚Ä¢ General Department\n‚Ä¢ Department of Physical Education" },

  { q: ["clubs","activities","nss","pta","placement","women cell","anti-ragging","union","literary","grievance"],
    a: "Clubs & Activities:\n‚Ä¢ National Service Scheme (NSS)\n‚Ä¢ Parent Teacher Association (PTA)\n‚Ä¢ Placement Cell\n‚Ä¢ Women Cell\n‚Ä¢ Anti-Ragging Cell\n‚Ä¢ College Union\n‚Ä¢ Boomitresena Club, ED Club\n‚Ä¢ Students Grievance Redressal\n‚Ä¢ Literary Club" },

  { q: ["facilities","labs","library","computer lab","electronics lab","seminar hall","canteen","fitness"],
    a: "Facilities:\n‚Ä¢ Computer lab\n‚Ä¢ Electronics lab\n‚Ä¢ Library\n‚Ä¢ Seminar hall\n‚Ä¢ Fitness Program\n‚Ä¢ Canteen\n‚Ä¢ Career Guidance Cell\n‚Ä¢ Placement Cell" },

  { q: ["exams","syllabus","exam"], a: "Exams & syllabus are provided and conducted by Calicut University." },

  { q: ["affiliation","calicut","calicut university","university"], a: "Affiliation: The college is affiliated to Calicut University." },

  { q: ["scholarship","scholarships"], a: "Scholarships are available for eligible students. Contact the college office for details." },

  { q: ["admission","how to apply","apply"], a:
`Admission summary:
UG Admission:
‚Ä¢ After +2 results.
‚Ä¢ Seats: B.Sc CS - 36; BCA - 24; B.Sc Electronics - 36; B.Com - 60.
‚Ä¢ 50% seats via Calicut University single-window; 50% via IHRD portal (apply at www.ihrdadmissions.org if applying for IHRD quota).

PG Admission:
‚Ä¢ After UG results.
‚Ä¢ Seats: M.Sc CS - 10; M.Com Finance - 15.
‚Ä¢ 50% seats via Calicut University single-window; 50% via IHRD portal (www.ihrdadmissions.org).` },

  { q: ["fee","fees","fee structure","fee details"], a: "Fee structure depends on the course. Ask a specific course fee: e.g. 'BCA fee', 'B.Sc Computer Science fee', 'B.Com fee', 'M.Sc fee', 'M.Com fee'." }
];

const COURSE_FEES = {
  "b.com": `B.Com (with Computer Application) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ9,200
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ100
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ9,900
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ11,200 (PTA & University fees not included)`,

  "b.sc cs": `B.Sc (Computer Science) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000 (PTA & University fees not included)`,

  "b.sc electronics": `B.Sc (Electronics) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000 (PTA & University fees not included)`,

  "bca": `BCA ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000 (PTA & University fees not included)`,

  "msc": `M.Sc (Computer Science) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ19,000
‚Ä¢ Students Amenities fee: ‚Çπ1,500
‚Üí Semester fee: ‚Çπ20,500
‚Ä¢ Admission fee: ‚Çπ1,000
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ22,500 (PTA & University fees not included)`,

  "mcom": `M.Com (Finance) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ18,425
‚Ä¢ Admission fee: ‚Çπ1,100
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ20,525 (PTA & University fees not included)`
};

/* ---------------------------
   Helpers & UI
----------------------------*/
const chatbox = document.getElementById('chatbox');
const input = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
const suggestList = document.getElementById('suggestList');
const suggestGrid = document.getElementById('suggestGrid');

function append(kind, text){
  const row = document.createElement('div');
  row.className = 'msg-row ' + (kind === 'you' ? 'you' : 'bot');
  const bubble = document.createElement('div');
  bubble.className = 'bubble ' + (kind === 'you' ? 'you' : 'bot');
  // allow limited HTML for bold, line breaks
  bubble.innerText = text;
  // preserve new lines
  bubble.innerText = text;
  row.appendChild(bubble);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
}

/* show bot bubble with HTML-friendly rendering for line breaks and bold */
function appendBot(text){
  const row = document.createElement('div');
  row.className = 'msg-row bot';
  const bubble = document.createElement('div');
  bubble.className = 'bubble bot';
  // convert newlines to <br> and allow bold markers if present
  const safe = escapeHtml(text).replace(/\n/g,'<br>');
  bubble.innerHTML = safe;
  row.appendChild(bubble);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
}

function appendUser(text){
  const row = document.createElement('div');
  row.className = 'msg-row you';
  const bubble = document.createElement('div');
  bubble.className = 'bubble you';
  bubble.innerText = text;
  row.appendChild(bubble);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
}

function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;" })[c]); }

/* typing indicator UI */
function showTyping(){
  const row = document.createElement('div');
  row.className = 'msg-row bot';
  const wrap = document.createElement('div'); wrap.className='typing';
  const d1 = document.createElement('span'); d1.className='dot';
  const d2 = document.createElement('span'); d2.className='dot';
  const d3 = document.createElement('span'); d3.className='dot';
  wrap.append(d1,d2,d3);
  row.appendChild(wrap);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
  return row;
}

/* ---------------------------
   Knowledge search & logic
----------------------------*/
function findResponse(text){
  const t = text.trim().toLowerCase();

  // greetings
  if (/\b(hi|hello|hey|hii|hey there|good morning|good evening)\b/.test(t)){
    return "Hello! How can I help you today? Try suggestions or ask something like 'BCA fee' or 'PG admission'.";
  }
  // thanks
  if (/\b(thank|thanks|thank you|tnx)\b/.test(t)){
    return "My pleasure! You're welcome üòä";
  }
  // how are you -> not "I'm fine"
  if (/\b(how are you|how r u|how r you)\b/.test(t)){
    return "I'm here and ready to help you with college information. How can I help?";
  }

  // course-specific fee priority (user asked "BCA fee" or "BCA")
  if (/\bbca\b/.test(t) && t.includes('fee')) return COURSE_FEES['bca'];
  if (/\bb\.?com\b/.test(t) && t.includes('fee')) return COURSE_FEES['b.com'];
  if ((/\bbsc\b/.test(t) || t.includes('computer science') || t.includes('b.sc')) && t.includes('fee')) {
    // check electronics vs cs keywords
    if (t.includes('elect') || t.includes('electronics')) return COURSE_FEES['b.sc electronics'];
    return COURSE_FEES['b.sc cs'];
  }
  if (/\bmsc\b/.test(t) && t.includes('fee')) return COURSE_FEES['msc'];
  if (/\bm\.?com\b/.test(t) && t.includes('fee')) return COURSE_FEES['mcom'];

  // PG/UG specific admission
  if (/\b(pg admission|pg admissions|postgraduate admission|msc admission|m.com admission|pg apply|m.sc admission)\b/.test(t)){
    return `PG Admission:
‚Ä¢ M.Sc Computer Science ‚Äì 10 seats
‚Ä¢ M.Com Finance ‚Äì 15 seats

Procedure:
‚Ä¢ 50% seats via Calicut University single-window
‚Ä¢ 50% seats via IHRD Centralised Admission Portal (www.ihrdadmissions.org)
If you choose IHRD quota apply in both systems.`;
  }
  if (/\b(ug admission|ug admissions|undergraduate admission|bca admission|b.sc admission|bcom admission)\b/.test(t)){
    return `UG Admission:
‚Ä¢ After +2 results.
‚Ä¢ Seats: B.Sc CS - 36; BCA - 24; B.Sc Electronics - 36; B.Com - 60.
‚Ä¢ 50% seats via Calicut University single-window; 50% via IHRD portal (www.ihrdadmissions.org).`;
  }
  // if user types "admission" general
  if (/\badmission\b/.test(t)) {
    // return combined summary
    return KB.find(i => i.q.includes('admission')).a;
  }

  // direct course names without 'fee' -> return fee as user wanted
  if (/\bbca\b/.test(t)) return COURSE_FEES['bca'];
  if (/\bb\.?com\b/.test(t) || /\bbcom\b/.test(t)) return COURSE_FEES['b.com'];
  if (/\bbsc\b/.test(t) && (t.includes('computer') || t.includes('cs'))) return COURSE_FEES['b.sc cs'];
  if (/\bbsc\b/.test(t) && t.includes('elect')) return COURSE_FEES['b.sc electronics'];
  if (/\bmsc\b/.test(t)) return COURSE_FEES['msc'];
  if (/\bm\.?com\b/.test(t)) return COURSE_FEES['mcom'];

  // search KB simple includes
  for (const item of KB){
    for (const key of item.q){
      if (t.includes(key)) return item.a;
    }
  }

  // unknown but clearly specific (parking / hostel / menus etc.) -> direct contact fallback
  if (/\b(parking|parking area|hostel|transport|bus|wifi|canteen|menu|facility count|how many facilities)\b/.test(t)){
    return "I understand your question. Please contact the college for these specific details:\nPhone: 0494 2689655\nEmail: casvattamkulam@ihrd.ac.in";
  }

  // default fallback
  return "I understand your question but this detail is not in my data. Please contact the college office:\nPhone: 0494 2689655\nEmail: casvattamkulam@ihrd.ac.in";
}

/* ---------------------------
   Auto-suggest logic
----------------------------*/
function getSuggestions(prefix){
  const p = prefix.trim().toLowerCase();
  if (!p || p.length < 2) return [];

  const suggestions = new Set();

  // course suggestions
  const courseMap = {
    "BCA fee": ["bca","bca fee"],
    "B.Com fee": ["b.com","bcom","b com","b.com fee"],
    "B.Sc CS fee": ["b.sc computer","bsc cs","computer science","b.sc cs"],
    "B.Sc Electronics fee": ["electronics","b.sc electronics","bsc electronics"],
    "M.Sc fee": ["msc","m.sc","m sc"],
    "M.Com fee": ["m.com","mcom"]
  };
  for (const label in courseMap){
    for (const k of courseMap[label]){
      if (k.includes(p) || p.includes(k) || label.toLowerCase().includes(p)) suggestions.add(label);
    }
  }

  // quick keywords
  const quick = {
    "Timing":"time",
    "Address":"address",
    "Courses":"courses",
    "Departments":"departments",
    "Clubs & Activities":"clubs",
    "Fees":"fee",
    "Admission":"admission",
    "PG admission":"pg admission",
    "UG admission":"ug admission",
    "Contact":"contact",
    "Scholarship":"scholarship",
    "Exams / syllabus":"exams"
  };
  for (const label in quick){
    if (label.toLowerCase().includes(p) || quick[label].includes(p)) suggestions.add(label);
  }

  return Array.from(suggestions).slice(0,8);
}

/* ---------------------------
   UI events and main flow
----------------------------*/

// initialize suggestion click behavior
suggestGrid.querySelectorAll('.suggest').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const q = btn.getAttribute('data-q');
    // put friendly text into input and send immediately
    const map = {
      timing: 'timing',
      address: 'address',
      courses: 'courses',
      fees: 'fee',
      admission: 'admission',
      departments: 'departments',
      clubs: 'clubs',
      contact: 'contact',
      scholarship: 'scholarship',
      exams: 'exams'
    };
    const text = map[q] || q;
    input.value = text;
    sendFromInput();
  });
});

// autosuggest typing
input.addEventListener('input', ()=>{
  const v = input.value;
  const items = getS
