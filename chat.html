<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CAS Chat ‚Äî College of Applied Science, Vattamkulam</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --rose:#ff9acb;
    --blue:#6ea8ff;
    --accent-blue:#0b63ff;   /* user bubble bg */
    --user-text:#000000;     /* black text for user bubble */
    --bot-green:#39ff14;     /* bot text on black */
    --bot-bg:#000000;
    --glass: rgba(255,255,255,0.88);
    --input-bg: rgba(255,255,255,0.95);
  }

  html,body{ height:100%; margin:0; font-family:"Poppins",system-ui,Arial,sans-serif; -webkit-font-smoothing:antialiased; }
  body{
    background: linear-gradient(135deg, var(--rose) 0%, #ffd7e6 30%, #cfe7ff 70%, var(--blue) 100%);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:16px;
    box-sizing:border-box;
  }

  /* main container */
  .wrap{
    width:100%;
    max-width:980px;
    height:92vh;
    background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.6));
    border-radius:16px;
    overflow:hidden;
    box-shadow: 0 20px 60px rgba(8,20,40,0.2);
    display:flex;
    flex-direction:column;
  }

  header{
    display:flex; gap:14px; align-items:center; padding:14px 18px;
    background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
    border-bottom: 1px solid rgba(0,0,0,0.03);
  }
  .logo{
    width:56px; height:56px; border-radius:12px;
    display:flex; align-items:center; justify-content:center;
    background: white;
  }
  .logo .cas{ font-family:"Abril Fatface", serif; color:var(--accent-blue); font-size:20px; }
  .head-text { display:flex; flex-direction:column; }
  .head-text .title { font-weight:700; color:#060606; font-size:18px; }
  .head-text .sub { font-size:12px; color:rgba(0,0,0,0.6); }

  /* body area */
  .body{
    padding:12px;
    display:flex;
    flex-direction:column;
    gap:12px;
    height:100%;
    box-sizing:border-box;
  }

  /* suggestion grid - large square buttons with emoji */
  .suggest-grid{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
    gap:10px;
    align-items:stretch;
  }
  .suggest{
    background: white;
    border-radius:12px;
    border:1px solid rgba(11,63,136,0.06);
    box-shadow: 0 8px 24px rgba(11,30,60,0.04);
    min-height:96px;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    gap:6px;
    cursor:pointer;
    padding:8px;
    transition: transform .12s ease, box-shadow .12s ease;
    text-align:center;
  }
  .suggest .emoji{ font-size:28px; }
  .suggest .label{ font-size:13px; color:#0b0b0b; }

  .suggest:active{ transform: translateY(2px); }

  /* chat area */
  #chatbox{
    flex:1;
    overflow:auto;
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:10px;
    -webkit-overflow-scrolling:touch;
  }

  .msg-row{ display:flex; }
  .msg-row.bot{ justify-content:flex-start; }
  .msg-row.you{ justify-content:flex-end; }

  .bubble{
    padding:12px 14px;
    border-radius:18px;
    max-width:78%;
    word-wrap:break-word;
    box-shadow: 0 8px 26px rgba(11,30,60,0.06);
    font-size:15px;
    line-height:1.35;
    white-space:pre-wrap; /* respect newlines in answers */
  }
  .bubble.you{
    background: var(--accent-blue);
    color: var(--user-text);
    border-bottom-right-radius:6px;
    border-bottom-left-radius:18px;
  }
  .bubble.bot{
    background: var(--bot-bg);
    color: var(--bot-green);
    border-bottom-left-radius:6px;
    border-bottom-right-radius:18px;
  }

  /* typing indicator bubble */
  .typing{
    padding:8px 10px;
    border-radius:12px;
    background: rgba(0,0,0,0.85);
    display:inline-flex;
    gap:6px;
    align-items:center;
  }
  .dot{
    width:7px; height:7px; border-radius:50%; background:var(--bot-green); animation: blink 1s infinite;
  }
  .dot:nth-child(2){ animation-delay: .2s; }
  .dot:nth-child(3){ animation-delay: .4s; }
  @keyframes blink{ 0%{opacity:.2} 50%{opacity:1} 100%{opacity:.2} }

  /* input area */
  .input-area{
    display:flex; gap:10px; align-items:center; padding:10px; background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
    border-top:1px solid rgba(0,0,0,0.03);
  }
  #userInput{
    flex:1;
    height:48px;
    padding:12px 16px;
    border-radius:28px 6px 28px 6px;
    border:none;
    outline:none;
    background:var(--input-bg);
    font-size:15px;
  }
  #userInput::placeholder{ color: rgba(0,0,0,0.35); }
  .btn-send{
    min-width:92px;
    height:44px;
    border-radius:10px;
    border:none;
    background: linear-gradient(90deg, var(--accent-blue), #0041d4);
    color:white;
    font-weight:700;
    cursor:pointer;
  }

  /* autosuggest dropdown (when typing) */
  .autosuggest{
    position:relative;
  }
  .suggest-list{
    position: absolute;
    left:0;
    right:0;
    bottom:58px;
    display:flex;
    flex-direction:column;
    gap:8px;
    padding:8px;
    background: rgba(255,255,255,0.98);
    border-radius:10px;
    box-shadow: 0 12px 40px rgba(11,30,60,0.08);
    z-index: 30;
  }
  .suggest-item{
    padding:8px 10px;
    border-radius:8px;
    cursor:pointer;
    font-size:14px;
  }
  .suggest-item:hover{ background:#f0f6ff; }

  /* responsiveness */
  @media (max-width:720px){
    .wrap{ height:96vh; border-radius:12px; }
    .suggest{ min-height:80px; }
    #chatbox{ padding:8px; }
  }
</style>
</head>
<body>
  <div class="wrap" role="application" aria-label="CAS chatbot">
    <header>
      <div class="logo" aria-hidden="true"><div class="cas">CAS</div></div>
      <div class="head-text">
        <div class="title">CHATBOT - CAS</div>
        <div class="sub">College of Applied Science, Vattamkulam</div>
      </div>
    </header>

    <div class="body">
      <!-- Suggestion grid -->
      <div class="suggest-grid" id="suggestGrid" aria-hidden="false">
        <div class="suggest" data-q="timing"><div class="emoji">üïí</div><div class="label">Timing</div></div>
        <div class="suggest" data-q="address"><div class="emoji">üìç</div><div class="label">Address</div></div>
        <div class="suggest" data-q="courses"><div class="emoji">üéì</div><div class="label">Courses</div></div>
        <div class="suggest" data-q="fees"><div class="emoji">üí∞</div><div class="label">Fees</div></div>
        <div class="suggest" data-q="admission"><div class="emoji">üìù</div><div class="label">Admission</div></div>
        <div class="suggest" data-q="departments"><div class="emoji">üè´</div><div class="label">Departments</div></div>
        <div class="suggest" data-q="clubs"><div class="emoji">‚ö°</div><div class="label">Clubs</div></div>
        <div class="suggest" data-q="contact"><div class="emoji">üìû</div><div class="label">Contact</div></div>
        <div class="suggest" data-q="scholarship"><div class="emoji">üéÅ</div><div class="label">Scholarship</div></div>
        <div class="suggest" data-q="exams"><div class="emoji">üìù</div><div class="label">Exams / Syllabus</div></div>
      </div>

      <!-- Chat box -->
      <div id="chatbox" role="log" aria-live="polite"></div>

      <!-- Input + autosuggest -->
      <div style="position:relative;">
        <div class="input-area autosuggest">
          <input id="userInput" type="text" placeholder="Type a question (example: 'BCA fee', 'PG admission', 'What is CAS?')">
          <button class="btn-send" id="sendBtn" aria-label="Send message">Send</button>
        </div>
        <div id="suggestList" class="suggest-list" style="display:none;"></div>
      </div>
    </div>
  </div>

<script>
/* ---------------------------
  Data store (knowledge base)
--------------------------- */
const KB = [
  // Basic contact & identity
  { q: ["what is cas","cas means","cas meaning","cas"], a: "CAS stands for College of Applied Science, Vattamkulam." },
  { q: ["address","location","where"], a: "College Address:\nThe Principal,\nCollege of Applied Science, Vattamkulam, Nellissery, Sukapuram (P.O.), Edappal, Malappuram, Kerala, PIN - 679576" },
  { q: ["phone","contact","telephone","call","office"], a: "Phone: 0494 2689655" },
  { q: ["email","mail"], a: "Email: casvattamkulam@ihrd.ac.in" },

  // Time
  { q: ["time","timing","hours","college time","when open","open"], a: "College time is 9:30 AM to 3:45 PM (Monday to Friday)." },

  // Courses
  { q: ["courses","what courses","available courses"], a: "Courses offered:\n‚Ä¢ B.Sc (Computer Science)\n‚Ä¢ B.Sc (Electronics)\n‚Ä¢ BCA\n‚Ä¢ B.Com with Computer Application\n‚Ä¢ M.Sc (Computer Science)\n‚Ä¢ M.Com (Finance)" },

  // Departments
  { q: ["departments","department","which departments"], a:
    "Departments:\n‚Ä¢ Department of Commerce\n‚Ä¢ Department of Computer Science\n‚Ä¢ Department of Electronics\n‚Ä¢ General Department\n‚Ä¢ Department of Physical Education" },

  // Clubs
  { q: ["clubs","activities","nss","pta","placement","women cell","anti-ragging","union","literary","grievance"],
    a: "Clubs & Activities:\n‚Ä¢ National Service Scheme (NSS)\n‚Ä¢ Parent Teacher Association (PTA)\n‚Ä¢ Placement Cell\n‚Ä¢ Women Cell\n‚Ä¢ Anti-Ragging Cell\n‚Ä¢ College Union\n‚Ä¢ Clubs & Associations (Boomitresena, ED Club)\n‚Ä¢ Students Grievance Redressal\n‚Ä¢ Literary Club" },

  // Facilities
  { q: ["facilities","labs","library","computer lab","electronics lab","seminar hall","canteen","fitness"],
    a: "Facilities:\n‚Ä¢ Computer lab\n‚Ä¢ Electronics lab\n‚Ä¢ Library\n‚Ä¢ Seminar hall\n‚Ä¢ Fitness Program\n‚Ä¢ Canteen\n‚Ä¢ Career Guidance Cell\n‚Ä¢ Placement Cell\n‚Ä¢ NCC/NSS & Clubs" },

  // Exams / syllabus
  { q: ["exams","syllabus","exam","syllabus provided"],
    a: "Exams & Syllabus: Provided and conducted by Calicut University." },

  // Affiliation & about
  { q: ["affiliation","calicut","calicut university","university"],
    a: "Affiliation: The college is affiliated to Calicut University." },

  // Scholarships
  { q: ["scholarship","scholarships"],
    a: "Scholarships: Scholarships are available for eligible students. Contact the college office for details." },

  // Admission (combined summary)
  { q: ["admission","how to apply","application","apply"],
    a:
`Admission summary:
UG Admission:
‚Ä¢ After +2 results.
‚Ä¢ Seats: B.Sc CS - 36; BCA - 24; B.Sc Electronics - 36; B.Com - 60.
‚Ä¢ 50% seats via Calicut University single-window; 50% via IHRD portal (apply at www.ihrdadmissions.org if applying for IHRD quota).

PG Admission:
‚Ä¢ After UG results.
‚Ä¢ Seats: M.Sc Computer Science - 10; M.Com Finance - 15.
‚Ä¢ 50% University single-window; 50% IHRD portal (www.ihrdadmissions.org).` },

  // Fee general (prompt to ask specific)
  { q: ["fee","fees","fee structure","fee details","fee structure per semester"],
    a: "Fee structure depends on the course. Ask a specific course fee: e.g. 'BCA fee', 'B.Sc Computer Science fee', 'B.Com fee', 'M.Sc fee', 'M.Com fee'." }
];

// Specific course fee entries (exact replies)
const COURSE_FEES = {
  "b.com": `B.Com (with Computer Application) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ9,200
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ100
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ9,900
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ11,200
(PTA & University affiliation fees not included)`,

  "b.sc cs": `B.Sc (Computer Science) ‚Äî Per semester (revised):
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000
(PTA & University affiliation fees not included)`,

  "b.sc electronics": `B.Sc (Electronics) ‚Äî Per semester (revised):
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000
(PTA & University affiliation fees not included)`,

  "bca": `BCA ‚Äî Per semester (revised):
‚Ä¢ Tuition fee: ‚Çπ14,900
‚Ä¢ Students Amenities fee: ‚Çπ250
‚Ä¢ Internet fee: ‚Çπ250
‚Ä¢ Lab fee: ‚Çπ200
‚Ä¢ Library fee: ‚Çπ100
‚Üí Semester fee: ‚Çπ15,700
‚Ä¢ Admission fee: ‚Çπ300
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ17,000
(PTA & University affiliation fees not included)`,

  "msc": `M.Sc (Computer Science) ‚Äî Per semester (revised):
‚Ä¢ Tuition fee: ‚Çπ19,000
‚Ä¢ Students Amenities fee: ‚Çπ1,500
‚Üí Semester fee: ‚Çπ20,500
‚Ä¢ Admission fee: ‚Çπ1,000
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ22,500
(PTA & University affiliation fees not included)`,

  "mcom": `M.Com (Finance) ‚Äî Per semester:
‚Ä¢ Tuition fee: ‚Çπ18,425
‚Ä¢ Admission fee: ‚Çπ1,100
‚Ä¢ Caution deposit (refundable): ‚Çπ1,000
‚Üí Total: ‚Çπ20,525
(PTA & University affiliation fees not included)`
};

/* ---------------------------
  Utilities & UI helpers
--------------------------- */
const chatbox = document.getElementById('chatbox');
const input = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
const suggestList = document.getElementById('suggestList');
const suggestGrid = document.getElementById('suggestGrid');

function appendMessage(kind, text){
  const row = document.createElement('div');
  row.className = 'msg-row ' + (kind === 'you' ? 'you' : 'bot');

  const bubble = document.createElement('div');
  bubble.className = 'bubble ' + (kind === 'you' ? 'you' : 'bot');
  bubble.innerText = text;

  row.appendChild(bubble);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
}

/* typing indicator: returns node to remove later */
function showTyping(){
  const row = document.createElement('div');
  row.className = 'msg-row bot';
  const wrap = document.createElement('div');
  wrap.className = 'typing';
  const d1 = document.createElement('span'); d1.className='dot';
  const d2 = document.createElement('span'); d2.className='dot';
  const d3 = document.createElement('span'); d3.className='dot';
  wrap.append(d1,d2,d3);
  row.appendChild(wrap);
  chatbox.appendChild(row);
  chatbox.scrollTop = chatbox.scrollHeight;
  return row;
}

/* escape (basic) */
function esc(s){ return String(s); }

/* Lowercase normalized */
function norm(s){ return (s||'').toLowerCase(); }

/* find KB match - returns a or null */
function findKBAnswer(text){
  const t = norm(text);

  // greetings
  if (/\b(hi|hello|hey|hii|hey there|good morning|good evening)\b/.test(t)) {
    return "Hello! How can I help you today? Try suggestions or ask a specific question like 'BCA fee' or 'PG admission'.";
  }
  // thanks
  if (/\b(thank|thanks|thank you|tnx)\b/.test(t)){
    return "My pleasure! You're welcome üòä";
  }
  // how are you - reply neutral helpful (not 'I am fine')
  if (/\b(how are you|how r u|how r you)\b/.test(t)){
    return "I'm here and ready to help you with college information. How can I help?";
  }

  // course-specific fee detection (priority)
  // check for clear course keywords
  if (/\bbca\b/.test(t) && t.includes('fee')) return COURSE_FEES['bca'];
  if (/\bb\.?\s?com\b/.test(t) || /\bbcom\b/.test(t) && t.includes('fee')) return COURSE_FEES['b.com'];
  if ((/\bb\.?sc\b/.test(t) || /\bbsc\b/.test(t) || t.includes('computer science')) && t.includes('fee')) return COURSE_FEES['b.sc cs'];
  if ((/\bbsc\b/.test(t) || t.includes('electronics')) && t.includes('fee')) return COURSE_FEES['b.sc electronics'];
  if (/\bmsc\b/.test(t) && t.includes('fee')) return COURSE_FEES['msc'];
  if (/\bm\.?com\b/.test(t) && t.includes('fee')) return COURSE_FEES['mcom'];

  // pg/ug admission specificity
  if (/\b(pg admission|pg admissions|postgraduate admission|msc admission|m.com admission|pg apply)\b/.test(t)) {
    return `PG Admission:\n‚Ä¢ M.Sc Computer Science ‚Äì 10 seats\n‚Ä¢ M.Com Finance ‚Äì 15 seats\nProcedure:\n‚Ä¢ 50% seats via Calicut University single-window\n‚Ä¢ 50% seats via IHRD Centralised Admission Portal (www.ihrdadmissions.org)\nApply in both if you choose IHRD quota.`;
  }
  if (/\b(ug admission|ug admissions|undergraduate admission|bca admission|b.sc admission|bcom admission)\b/.test(t)) {
    return `UG Admission:\n‚Ä¢ After +2 results.\n‚Ä¢ Seats: B.Sc CS - 36; BCA - 24; B.Sc Electronics - 36; B.Com - 60.\n‚Ä¢ 50% seats via Calicut University single-window; 50% via IHRD portal (www.ihrdadmissions.org).`;
  }

  // exact course fee short queries without 'fee' but meaning fee
  if (/\bbca\b/.test(t) && !t.includes('admission')) return COURSE_FEES['bca'];
  if (/\bb\.?com\b/.test(t) || /\bbcom\b/.test(t)) return COURSE_FEES['b.com'];
  if (/\bbsc\b/.test(t) && (t.includes('computer') || t.includes('cs') || t.includes('electronics'))) {
    if (t.includes('electronics')) return COURSE_FEES['b.sc electronics'];
    return COURSE_FEES['b.sc cs'];
  }
  if (/\bmsc\b/.test(t)) return COURSE_FEES['msc'];
  if (/\bm\.?com\b/.test(t)) return COURSE_FEES['mcom'];

  // search KB array
  for (const item of KB){
    for (const key of item.q){
      if (t.includes(key)) return item.a;
    }
  }

  // if asks about number of facilities / parking / specific unstored data -> contact fallback
  if (/\b(parking|parking area|parking lot|hostel|transport|bus|wifi|wifi speed|canteen cost|canteen menu|number of facilities|facility count)\b/.test(t)){
    return "I understand what you asked. Please contact the college for these specific details:\nPhone: 0494 2689655\nEmail: casvattamkulam@ihrd.ac.in";
  }

  // final default fallback
  return "I understand your question but this detail is not in my data. Please contact the college office:\nPhone: 0494 2689655\nEmail: casvattamkulam@ihrd.ac.in";
}

/* Smart autosuggest: find relevant suggestion keywords from KB and COURSE_FEES */
function getAutoSuggestions(prefix){
  const t = norm(prefix);
  if (!t || t.length < 2) return [];
  const suggestions = new Set();

  // course keys
  const courseKeys = {
    "BCA fee": ["bca"],
    "B.Com fee": ["b.com","bcom","b com"],
    "B.Sc CS fee": ["b.sc computer", "bsc cs", "computer science"],
    "B.Sc Electronics fee": ["bsc electronics","electronics"],
    "M.Sc fee": ["msc","m.sc"],
    "M.Com fee": ["m.com","mcom"]
  };

  for (const label in courseKeys){
    for (const k of courseKeys[label]){
      if (k.includes(t) || t.includes(k)) suggestions.add(label);
    }
  }

  // KB keys - check keywords present
  const quick = {
    "Timing":"time",
    "Address":"address",
    "Courses":"courses",
    "Departments":"departments",
    "Clubs & Activities":"clubs",
    "Fees":"fee",
    "Admission":"admission",
    "PG admission":"pg admission",
    "Contact":"contact",
    "Scholarships":"scholarship",
    "Exams / syllabus":"exams"
  };
  for (const label in quick){
    if (label.toLowerCase().includes(t) || quick[label].includes(t)) suggestions.add(label);
  }

  return Array.from(suggestions).slice(0,8);
}

/* ---------------------------
  Event handlers & flow
--------------------------- */

function showSuggestionsList(items){
  if (!items || items.length === 0){ suggestList.style.display = 'none'; suggestList.innerHTML = ''; return; }
  suggestList.style.display = 'block';
  suggestList.innerHTML = '';
  items.forEach(i=>{
    const it = document.createElement('div');
    it.className = 'suggest-item';
    it.innerText = i;
    it.onclick = ()=> {
      input.value = i;
      suggestList.style.display = 'none';
      sendFromInput();
    };
    suggestList.appendChild(it);
  });
}

input.addEventListener('input', (e)=>{
  const v = input.value.trim();
  const suggestions = getAutoSuggestions(v);
  showSuggestionsList(suggestions);
});

// clicking a big suggestion button
suggestGrid.querySelectorAll('.suggest').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const q = btn.getAttribute('data-q');
    // map q to user friendly text
    const map = {
      timing: 'timing',
      address: 'address',
      courses: 'courses',
      fees: 'fee',
      admission: 'admission',
      departments: 'departments',
      club
